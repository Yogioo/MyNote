<html>
<head>
  <title>Blend Tree 融合树</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="606"/>
<h1>Blend Tree 融合树</h1>

<div>
<span><div><h1 style="box-sizing: border-box; margin: 27px 0px 0px; padding: 0px; font-size: 24px; vertical-align: middle; color: rgb(34, 34, 34); font-family: &quot;Microsoft YaHei&quot;, &quot;PingFang SC&quot;, &quot;Heiti SC&quot;, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; font-size: 24px; vertical-align: middle; color: rgb(34, 34, 34); font-family: &quot;Microsoft YaHei&quot;, &quot;PingFang SC&quot;, &quot;Heiti SC&quot;, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Unity动画之Blend Tree（混合树）</span></h1><div style="box-sizing: border-box; margin-top: 10px; font-size: 14px; color: rgb(113, 113, 113); font-family: &quot;Microsoft YaHei&quot;, &quot;PingFang SC&quot;, &quot;Heiti SC&quot;, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></div><div style="box-sizing: border-box; min-height: 400px;"><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">混合树 (Blend Tree) 用于允许通过按不同程度组合所有动画的各个部分来平滑混合多个动画，本篇文章和大家分享的是使用混合树动画</span><span style="box-sizing: border-box;">实现人物在跑的状态下，才能进行转弯操作，和跳起动作</span><span style="box-sizing: border-box;">的效果。</span></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">1、Unity中的动画混合树可以将几个动画文件很好的融合在一起其中Run是状态树：</span></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image.png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><br style="box-sizing: border-box;"/></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image [1].png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><br style="box-sizing: border-box;"/></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image [2].png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">参数Direction是浮点类型。上面概述为：动画状态可以是单个的动画文件，也可以是由动画文件融合成的状态树。勾选automate threshold可以修改thresl临界值</span></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">2、第一步已经在</span><span style="box-sizing: border-box;">Unity</span><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">面板中把先关参数配置好了，现在就需要用脚本来设置相关参数条件的实现。</span></div><div style="box-sizing: border-box;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; white-space: pre-wrap;"><div>using UnityEngine;</div><div>using System.Collections;</div><div>public class BlendTree : MonoBehaviour ｛</div><div>protected Animator animator;</div><div>public float DirectionDamoTime = 0.25f;</div><div>void Start () ｛</div><div>animator = GetComponent&lt;Animator&gt;();</div><div>｝</div><div>void Update () ｛</div><div>if(animator)</div><div>｛</div><div>AnimatorStateInfo stateInfo = animator.GetCurrentAnimatorStateInfo(0);</div><div>if (stateInfo.IsName(&quot;Base Layer.Run&quot;))//注意这里必须是Base Layer.Run Base Layer是动画层的名称，用.的形式引出当前准备切换动画的动画状态名称</div><div>｛</div><div>if (Input.GetKeyDown(KeyCode.Space))</div><div>animator.SetBool(&quot;Jump&quot;, true);</div><div>｝</div><div>else</div><div>｛</div><div>animator.SetBool(&quot;Jump&quot;, false);</div><div>｝</div><div>//在奔跑时才可以水平旋转</div><div>float horizontal = Input.GetAxis(&quot;Horizontal&quot;);</div><div>animator.SetFloat(&quot;Direction&quot;, horizontal, DirectionDamoTime, Time.deltaTime);</div><div>//控制idle到跑状态的切换</div><div>if (Input.GetKeyDown(KeyCode.W))</div><div>｛</div><div>animator.SetFloat(&quot;Blend&quot;, 1.0f);</div><div>｝</div><div>else if (Input.GetKeyUp(KeyCode.W))</div><div>｛</div><div>animator.SetFloat(&quot;Blend&quot;, -0.1f);</div><div>｝</div><div>｝</div><div>｝</div><div>｝</div></div></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">3、基本概念</span></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image [3].png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">第二个参数如果变为负值可以修改动画运动的方向。动画混合树，实际上也是一个动画状态单元，和普通的动画状态不同的是，他可以混合多个动画。</span></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">4、在BlendTree 的2D融合图中：</span></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image [4].png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">设置为-1  可以让动画反向播放，在有向前走而没有向后走的动画时。</span></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">5、2D融合图的操作步骤：</span></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box;">a.在动画控制器中，建立默认状态为BlendTree</span></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image [5].png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">b.</span><span style="box-sizing: border-box;">type选择2D，parameter自己创建参数，此参数会在脚本中运用到，并将四个动画文件子对象的相关位置设置好之后，在unity面板中的配置就完成了：</span></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image [6].png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">c.脚本的控制：</span></div><div style="box-sizing: border-box;"><div style="box-sizing: border-box; margin: 0px; padding: 0px; white-space: pre-wrap;"><div>using UnityEngine;</div><div>using System.Collections;</div><div>public class BlendTree2D : MonoBehaviour ｛</div><div>private Animator ani;</div><div>public float xDampTime = 1.0f;</div><div>public float yDampTime = 1.0f;</div><div>//动画参数的系数</div><div>float xVal = 1.5f;</div><div>float yVal = 1.5f;</div><div>void Start () ｛</div><div>ani = gameObject.GetComponent&lt;Animator&gt;();</div><div>｝</div><div>void Update () ｛</div><div>if(ani)</div><div>｛</div><div>float h = Input.GetAxis(&quot;Horizontal&quot;);</div><div>float v = Input.GetAxis(&quot;Vertical&quot;);</div><div>ani.SetFloat(&quot;ValX&quot;, h, xDampTime, Time.deltaTime);</div><div>ani.SetFloat(&quot;ValY&quot;, v, yDampTime, Time.deltaTime);</div><div>｝</div><div>｝</div><div>｝</div></div></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">这样就能很好的对角色进行，前进，后退，左右运动的控制了。</span></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">d.数值的大小，影响着动画播放的快慢。越小播放越快。</span></div><div style="box-sizing: border-box;"><img src="Blend Tree 融合树_files/Image [7].png" type="image/png" data-filename="Image.png" style="box-sizing: border-box; border: none; display: inline-block; vertical-align: top; max-width: 100%; height: auto;"/></div><div style="box-sizing: border-box;"><span style="box-sizing: border-box; font-family: &quot;Microsoft YaHei, Arial, sans-serif&quot;;">动画融合就是设置权重的大小将动画进行融合</span></div></div><div><br/></div></div></span>
</div></body></html> 